{% extends 'monitoreo/base.html' %}

{% block content %}

<!-- DataTables CSS y JS + Botones de exportaciÃ³n -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">

<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>

<div class="container mt-5" data-aos="fade-up">
    <h2 class="text-center mb-4">ðŸ“‹ Panel de Eventos â€“ Doctor</h2>

    {% if eventos %}
    <div class="table-responsive">
        <table id="tabla-doctor" class="table table-bordered table-striped">
            <thead class="table-light text-center">
                <tr>
                    <th>Tipo</th>
                    <th>Criticidad</th>
                    <th>Fecha</th>
                    <th>Hora</th>
                    <th>Dispositivo</th>
                </tr>
            </thead>
            <tbody class="text-center">
                {% for e in eventos %}
                <tr>
                    <td>{{ e.get_tipo_display }}</td>
                    <td>{{ e.criticidad|title }}</td>
                    <td>{{ e.fecha }}</td>
                    <td>{{ e.hora }}</td>
                    <td>{{ e.dispositivo }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="alert alert-info text-center">No se encontraron eventos registrados.</div>
    {% endif %}
</div>

<script>
$(document).ready(function () {
    $('#tabla-doctor').DataTable({
        pageLength: 10,
        order: [[2, 'desc']],
        dom: 'Bfrtip',
        buttons: [
            {
                extend: 'pdfHtml5',
                text: 'ðŸ“„ Exportar PDF',
                title: 'Eventos registrados',
                className: 'btn btn-danger'
            }
        ],
        language: {
            url: "//cdn.datatables.net/plug-ins/1.13.6/i18n/es-ES.json"
        }
    });
});
</script>

{% endblock %}
